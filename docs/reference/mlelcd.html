<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Uses Shor's \(r\)-algorithm to compute the maximum
 likelihood estimator of a log-concave density based on an
 i.i.d. sample.  The estimator is uniquely determined by its value at the data
 points. The output is an object of class &quot;LogConcDEAD&quot; which
  contains all the information needed to plot the estimator using the
  plot method, or to evaluate it using
  the function dlcd."><title>Compute the maximum likelihood estimator of a log-concave density — mlelcd • LogConcDEAD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the maximum likelihood estimator of a log-concave density — mlelcd"><meta property="og:description" content="Uses Shor's \(r\)-algorithm to compute the maximum
 likelihood estimator of a log-concave density based on an
 i.i.d. sample.  The estimator is uniquely determined by its value at the data
 points. The output is an object of class &quot;LogConcDEAD&quot; which
  contains all the information needed to plot the estimator using the
  plot method, or to evaluate it using
  the function dlcd."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LogConcDEAD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.6-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute the maximum likelihood estimator of a log-concave density</h1>
      
      <div class="d-none name"><code>mlelcd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses Shor's \(r\)-algorithm to compute the maximum
 likelihood estimator of a log-concave density based on an
 i.i.d. sample.  The estimator is uniquely determined by its value at the data
 points. The output is an object of class <code>"LogConcDEAD"</code> which
  contains all the information needed to plot the estimator using the
  <code><a href="plot.LogConcDEAD.html">plot</a></code> method, or to evaluate it using
  the function <code><a href="dlcd.html">dlcd</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mlelcd</span><span class="op">(</span><span class="va">x</span>, w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="LogConcDEAD-internal.html">initialy</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  verbose<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">5</span>, c<span class="op">=</span><span class="fl">1</span>, sigmatol<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span>, integraltol<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>,</span>
<span>  ytol<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span>, Jtol<span class="op">=</span><span class="fl">0.001</span>, chtol<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Data in \(R^d\), in the form of an \(n
      \times d\) numeric <code>matrix</code></p></dd>

  <dt>w</dt>
<dd><p>Vector of weights \(w_i\) such that the computed estimator
  maximizes $$\sum_{i=1}^n w_i \log f(x_i)$$</p></dd>
</dl><p>subject to the restriction that \(f\) is
  log-concave. The default is  \(\frac{1}{n}\) for all \(i\),
  which corresponds to i.i.d. observations.</p>
<dl><dt>y</dt>
<dd><p>Vector giving starting point for the \(r\)-algorithm.
    If none given, a kernel estimate is used.</p></dd>

  <dt>verbose</dt>
<dd><p></p><ul><li><p>-1: (default) prints nothing</p></li>
<li><p>0: prints warning messages</p></li>
<li><p>\(n&gt;0\): prints summary information every \(n\)
      iterations</p></li>
</ul><p></p></dd>

  <dt>alpha</dt>
<dd><p>Scalar parameter for <span class="pkg">SolvOpt</span></p></dd>

  <dt>c</dt>
<dd><p>Scalar giving starting step size</p></dd>

  <dt>sigmatol</dt>
<dd><p>Real-valued scalar giving one of the stopping
  criteria: Relative change in \(\sigma\) must be below
  <code>sigmatol</code> for algorithm to terminate. (See Details)</p></dd>

  <dt>ytol</dt>
<dd><p>Real-valued scalar giving on of the stopping criteria: Relative change in \(y\) must be
  below <code>ytol</code> for algorithm to terminate. (See
    Details)</p></dd>

  <dt>integraltol</dt>
<dd><p>Real-valued scalar giving one of the stopping
    criteria:  \(| 1 - \exp(\bar{h}_y) |\) must be below
  <code>integraltol</code> for algorithm to terminate. (See Details)</p></dd>

  <dt>Jtol</dt>
<dd><p>Parameter controlling when Taylor expansion is used in
    computing the function \(\sigma\)</p></dd>

  <dt>chtol</dt>
<dd><p>Parameter controlling convex hull computations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The log-concave maximum likelihood density estimator based on data
  \(X_1, \ldots, X_n\) is the function that maximizes
  $$\sum_{i=1}^n w_i \log f(X_i)$$ subject to the constraint that \(f\) is
  log-concave. For i.i.d.~data, the weights \(w_i\) should be
  \(\frac{1}{n}\) for each \(i\).</p>  
<p>This is a function of the form \(\bar{h}_y\) for some \(y
    \in R^n\), where $$\bar{h}_y(x)
    = \inf \lbrace h(x) \colon h \textrm{ concave }, h(x_i) \geq y_i
    \textrm{ for } i = 1, \ldots, n \rbrace.$$</p>
<p>Functions of this form may equivalently be specified by dividing
  \(C_n\), the convex hull of the data, into simplices \(C_j\) for
  \(j \in J\) (triangles in 2d, tetrahedra in 3d etc), and setting
  $$f(x) = \exp\{b_j^T x - \beta_j\}$$
  for \(x \in C_j\), and \(f(x) = 0\) for \(x \notin
  C_n\).</p>  
<p>This function uses Shor's \(r\)-algorithm (an iterative
  subgradient-based procedure) to minimize over vectors \(y\) in
  \(R^n\) the function $$\sigma(y) = -\frac{1}{n} \sum_{i=1}^n y_i
  + \int \exp(\bar{h}_y(x)) \, dx.$$  This is equivalent to finding the log-concave
  maximum likelihood estimator, as demonstrated in <cite>Cule, Samworth
  and Stewart (2008)</cite>.</p>  
<p>An implementation of Shor's \(r\)-algorithm based on <span class="pkg">SolvOpt</span>
is used.</p>
<p>Computing \(\sigma\) makes use of the <span class="pkg">qhull</span> library.
Code from this C-based library is copied here as it is not currently 
possible to use compiled code from another library.  
For points not in general position, this requires a Taylor expansion of 
\(\sigma\), discussed in <cite>Cule and D\"umbgen (2008)</cite>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"LogConcDEAD"</code>, with the following
  components:</p>
<dl><dt>x</dt>
<dd><p>Data copied from input (may be reordered)</p></dd>

  <dt>w</dt>
<dd><p>weights copied from input (may be reordered)</p></dd>

  <dt>logMLE</dt>
<dd><p><code>vector</code> of
    the log of the maximum likelihood estimate, evaluated at the observation points</p></dd>

  <dt>NumberOfEvaluations</dt>
<dd><p>Vector containing the number of steps, number of function
    evaluations, and number of subgradient evaluations.  If the <span class="pkg">SolvOpt</span>
    algorithm fails, the first component will be an error code \((&lt;0)\).</p></dd>

  <dt>MinSigma</dt>
<dd><p>Real-valued scalar giving minimum value of the objective function</p></dd>

  <dt>b</dt>
<dd><p><code>matrix</code> (see Details)</p></dd>

  <dt>beta</dt>
<dd><p><code>vector</code> (see Details)</p></dd>

  <dt>triang</dt>
<dd><p><code>matrix</code> containing final triangulation of the convex hull of the data</p></dd>

  <dt>verts</dt>
<dd><p><code>matrix</code> containing details of triangulation for use in <code><a href="dlcd.html">dlcd</a></code></p></dd>

  <dt>vertsoffset</dt>
<dd><p><code>matrix</code> containing details of triangulation for use in <code><a href="dlcd.html">dlcd</a></code></p></dd>

<dt>chull</dt>
<dd><p>Vector containing vertices of faces of the convex hull of
  the data</p></dd>

<dt>outnorm</dt>
<dd><p><code>matrix</code> where each row is an outward
  pointing normal vectors for the faces of the convex hull of the
  data. The number of vectors depends on the number of faces of the
  convex hull.</p></dd>

<dt>outoffset</dt>
<dd><p><code>matrix</code> where each row is a point on a face of
  the convex hull of the data. The number of vectors depends on the
  number of faces of the convex hull.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barber, C.B., Dobkin, D.P., and Huhdanpaa, H.T. (1996)
<em>The Quickhull algorithm for convex hulls</em>
  ACM Trans. on Mathematical Software, 22(4) p.469-483
<a href="http://www.qhull.org" class="external-link">http://www.qhull.org</a></p>
<p>Cule, M. L. and D\"umbgen, L. (2008) On an auxiliary function for
log-density estimation, University of Bern technical report. <a href="https://arxiv.org/abs/0807.4719" class="external-link">https://arxiv.org/abs/0807.4719</a></p>
<p>Cule, M. L., Samworth, R. J., and Stewart, M. I. (2010)
<em>Maximum likelihood estimation of a log-concave density</em>,
  Journal of the Royal Statistical Society, Series B, 72(5) p.545-607.</p>
<p>Kappel, F. and Kuntsevich, A. V. (2000)
<em>An implementation of Shor's r-algorithm</em>,
  Computational Optimization and Applications, Volume 15, Issue 2, 193-205.</p>
<p>Shor, N. Z. (1985)
<em>Minimization methods for nondifferentiable functions</em>,
  Springer-Verlag</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>For one-dimensional data, the active set algorithm of
  <code>logcondens</code> is faster, and may be
  preferred.</p>
<p>The authors gratefully acknowledge the assistance of Lutz Duembgen
  at the University of Bern for his insight into the objective function
  \(\sigma\).</p>
<p>Further references, including definitions and background material, may be found in <cite>Cule, Samworth and Stewart (2010)</cite>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Madeleine Cule</p>  
<p>Robert B. Gramacy</p>
<p>Richard Samworth</p>  
<p>Yining Chen</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>logcondens</code>, 
  <code><a href="interplcd.html">interplcd</a></code>,  <code><a href="plot.LogConcDEAD.html">plot.LogConcDEAD</a></code>, 
  <code><a href="interpmarglcd.html">interpmarglcd</a></code>, <code><a href="rlcd.html">rlcd</a></code>, <code><a href="dlcd.html">dlcd</a></code>,</p>
<p><code><a href="dmarglcd.html">dmarglcd</a></code>, <code><a href="cov.LogConcDEAD.html">cov.LogConcDEAD</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Some simple normal data, and a few plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lcd</span> <span class="op">&lt;-</span> <span class="fu">mlelcd</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="interplcd.html">interplcd</a></span><span class="op">(</span><span class="va">lcd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, ask<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, g<span class="op">=</span><span class="va">g</span>, type<span class="op">=</span><span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, g<span class="op">=</span><span class="va">g</span>, type<span class="op">=</span><span class="st">"c"</span>, uselog<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, g<span class="op">=</span><span class="va">g</span>, type<span class="op">=</span><span class="st">"i"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, g<span class="op">=</span><span class="va">g</span>, type<span class="op">=</span><span class="st">"i"</span>, uselog<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mlelcd-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2D interactive plot (need rgl package, not run here)</span></span></span>
<span class="r-in"><span><span class="co">#  plot(lcd, type="r")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Some plots of marginal estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g.marg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="interpmarglcd.html">interpmarglcd</a></span><span class="op">(</span><span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g.marg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="interpmarglcd.html">interpmarglcd</a></span><span class="op">(</span><span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">1</span>, g.marg<span class="op">=</span><span class="va">g.marg1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mlelcd-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">2</span>, g.marg<span class="op">=</span><span class="va">g.marg2</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="mlelcd-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate some points from the fitted density</span></span></span>
<span class="r-in"><span><span class="co">## via independent rejection sampling</span></span></span>
<span class="r-in"><span><span class="va">generated1</span> <span class="op">&lt;-</span> <span class="fu"><a href="rlcd.html">rlcd</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">lcd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">generated1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.2094174 -0.1760564</span>
<span class="r-in"><span><span class="co">## via Metropolis-Hastings algorithm</span></span></span>
<span class="r-in"><span><span class="va">generated2</span> <span class="op">&lt;-</span> <span class="fu"><a href="rlcd.html">rlcd</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">lcd</span>, <span class="st">"MH"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">generated2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.10072359 0.06037948</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## evaluate the fitted density</span></span></span>
<span class="r-in"><span><span class="va">mypoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dlcd.html">dlcd</a></span><span class="op">(</span><span class="va">mypoint</span>, <span class="va">lcd</span>, uselog<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1573178</span>
<span class="r-in"><span><span class="va">mypoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dlcd.html">dlcd</a></span><span class="op">(</span><span class="va">mypoint</span>, <span class="va">lcd</span>, uselog<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1069506</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## evaluate the marginal density</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dmarglcd.html">dmarglcd</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.424504</span>
<span class="r-in"><span><span class="fu"><a href="dmarglcd.html">dmarglcd</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">lcd</span>, marg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2541608</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## evaluate the covariance matrix of the fitted density</span></span></span>
<span class="r-in"><span><span class="va">covariance</span> <span class="op">&lt;-</span> <span class="fu"><a href="cov.LogConcDEAD.html">cov.LogConcDEAD</a></span><span class="op">(</span><span class="va">lcd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## find the hat matrix for the smoothed log-concave that</span></span></span>
<span class="r-in"><span><span class="co">## matches empirical mean and covariance</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="hatA.html">hatA</a></span><span class="op">(</span><span class="va">lcd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## evaluate the fitted smoothed log-concave density</span></span></span>
<span class="r-in"><span><span class="va">mypoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dslcd.html">dslcd</a></span><span class="op">(</span><span class="va">mypoint</span>, <span class="va">lcd</span>, <span class="va">A</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1380299</span>
<span class="r-in"><span><span class="va">mypoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dslcd.html">dslcd</a></span><span class="op">(</span><span class="va">mypoint</span>, <span class="va">lcd</span>, <span class="va">A</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.106271</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate some points from the fitted smoothed log-concave density</span></span></span>
<span class="r-in"><span><span class="va">generated</span> <span class="op">&lt;-</span> <span class="fu"><a href="rslcd.html">rslcd</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">lcd</span>, <span class="va">A</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Developed by Yining Chen.</p>
</div>

    </footer></div>

  

  

  </body></html>

