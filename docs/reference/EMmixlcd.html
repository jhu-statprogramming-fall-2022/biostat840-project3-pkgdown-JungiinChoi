<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Uses EM algorithm to estimate the mixture proportions and the component
  densities. The output is an object of class "lcdmix" which
  contains mixture proportions at each observation and all the information of the 
  estimated component densities.'><title>Estimate the mixture proportions and component densities using EM algorithm — EMmixlcd • LogConcDEAD</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the mixture proportions and component densities using EM algorithm — EMmixlcd"><meta property="og:description" content='Uses EM algorithm to estimate the mixture proportions and the component
  densities. The output is an object of class "lcdmix" which
  contains mixture proportions at each observation and all the information of the 
  estimated component densities.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LogConcDEAD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.6-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimate the mixture proportions and component densities using EM algorithm</h1>
      
      <div class="d-none name"><code>EMmixlcd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses EM algorithm to estimate the mixture proportions and the component
  densities. The output is an object of class <code>"lcdmix"</code> which
  contains mixture proportions at each observation and all the information of the 
  estimated component densities.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EMmixlcd</span><span class="op">(</span> <span class="va">x</span>, k <span class="op">=</span> <span class="fl">2</span>, <span class="va">y</span>, <span class="va">props</span>, epsratio<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span>, max.iter<span class="op">=</span><span class="fl">50</span>,</span>
<span>            epstheta<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">8</span>, verbose<span class="op">=</span><span class="op">-</span><span class="fl">1</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Data in \(R^d\), in the form of an \(n
      \times d\) numeric <code>matrix</code></p></dd>

  <dt>k</dt>
<dd><p>The number of components, equals 2 by default</p></dd>
   
  <dt>y</dt>
<dd><p>An \(n \times k\) numeric <code>matrix</code> giving the starting values for the EM 
      algorithm. If none given, a hierachical Gaussian clustering model is used. To reduce the 
      computational burden while allowing sufficient flexibility for the EM algorithm, it is recommended 
      to leave this argument unspecified.</p></dd>

  <dt>props</dt>
<dd><p>Vector of length \(k\) containing the starting value of proportions.
      If none given, a hierachical Gaussian clustering model is used. To reduce the 
      computational burden while allowing sufficient flexibility for the EM algorithm, 
      it is recommended to leave this argument unspecified.</p></dd>

  <dt>epsratio</dt>
<dd><p>EM algorithm will terminate if the increase in the proportion of the likelihood is 
      less than this specified ratio. Default value is \(10^{-6}\).</p></dd>

  <dt>max.iter</dt>
<dd><p>The maximum number of iterations for the EM algorithm</p></dd>

  <dt>epstheta</dt>
<dd><p>\(epstheta/n\) is the thresold of the weight below which data point is 
      discarded from the cluster. This quantity is introduced to increase the computational efficiency
      and stability.</p></dd>

  <dt>verbose</dt>
<dd><p></p><ul><li><p>-1: (default) prints nothing</p></li>
<li><p>0: prints warning messages</p></li>
<li><p>\(&gt;0\): prints summary information every \(n\) iterations</p></li>
</ul><p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An introduction to the Em algorithm can be found in <cite>McLachlan and Krishnan (1997)</cite>.
  Briefly, given the current estimates of the mixture proportions and component densities, we first 
  update the estimates of the mixture prroportions. We then update the estimates of the component 
  densities by using <code><a href="mlelcd.html">mlelcd</a></code>. In fact, the incorporation of the weights in the 
  maximization process in <code><a href="mlelcd.html">mlelcd</a></code> presents no additional complication.</p>
<p>In our case, because of the computational intensity of the method, we first cluster the points 
  according to ta hierarchical Gaussian clustering model and then iterate the EM algorithm until the 
  increase in the proportion of the likelihood is less than a pre-specified quantity at each step.</p>
<p>More technical details can be found in <cite>Cule, Samworth and Stewart(2010)</cite></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"lcdmix"</code>, with the following components:</p>
<dl><dt>x</dt>
<dd><p>Data copied from input (may be reordered)</p></dd>

  <dt>logf</dt>
<dd><p>An \(n \times k\) <code>maxtrix</code> of the log of the maximum likelihood estimate, 
    evaluated at the observation points for each component.</p></dd>

  <dt>props</dt>
<dd><p>Vector containing the estimated proportions of components</p></dd>

  <dt>niter</dt>
<dd><p>Number of iterations of the EM algorithm</p></dd>

  <dt>lcdloglik</dt>
<dd><p>The log-likelihood after the final iteration</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    

<p>Cule, M. L., Samworth, R. J., and Stewart, M. I. (2010)
<em>Maximum likelihood estimation of a log-concave density</em>,
  Journal of the Royal Statistical Society, Series B, 72(5) p.545-607.</p>
<p>McLachlan, G. J. and Krishnan, T. (1997) 
<em>The EM Algorithm and Extensions</em>, New York: Wiley.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yining Chen</p>  
<p>Madeleine Cule</p>  
<p>Robert B. Gramacy</p>
<p>Richard Samworth</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://mclust-org.github.io/mclust/reference/hc.html" class="external-link">mclust</a></code>,
  <code>logcondens</code>,
  <code><a href="plot.LogConcDEAD.html">plot.LogConcDEAD</a></code>,<code><a href="mlelcd.html">mlelcd</a></code>, <code><a href="dlcd.html">dlcd</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##Simple bivariate normal data</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span> <span class="fl">1</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">props</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.6</span>, <span class="fl">0.4</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">shift</span><span class="op">=</span><span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">n</span><span class="op">*</span><span class="va">d</span> <span class="op">)</span>, ncol <span class="op">=</span> <span class="va">d</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">shiftvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="va">n</span> <span class="op">)</span> <span class="op">&gt;</span> <span class="va">props</span><span class="op">[</span> <span class="fl">1</span> <span class="op">]</span>, <span class="fl">0</span>, <span class="va">shift</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">shiftvec</span></span></span>
<span class="r-in"><span>  <span class="fu">EMmixlcd</span><span class="op">(</span> <span class="va">x</span>, k <span class="op">=</span> <span class="fl">2</span>, max.iter <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -0.6264538 -0.04493361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.1836433 -0.01619026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.1643714  0.94383621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  3.5952808  0.82122120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.3295078  0.59390132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  1.1795316  0.91897737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  2.4874291  0.78213630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.7383247  0.07456498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  2.5757814 -1.98935170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.3053884  0.61982575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  3.5117812 -0.05612874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.3898432 -0.15579551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  1.3787594 -1.47075238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.2146999 -0.47815006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  3.1249309  0.41794156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -0.9406511       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]       -Inf -1.0749647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.2729687       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]       -Inf -0.5484670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.3155728       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.2900564       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]       -Inf -0.6120231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.1142542       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]       -Inf -2.1764194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.8230307       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]       -Inf -1.0478670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.1141248       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]       -Inf -1.9278556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.5261604       -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]       -Inf -0.7941805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $props</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5333333 0.4666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $niter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lcdloglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -20.58789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lcdmix"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Developed by Yining Chen.</p>
</div>

    </footer></div>

  

  

  </body></html>

